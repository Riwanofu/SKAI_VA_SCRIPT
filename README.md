Настройка терминалов Streamax через скрипт на ПК




В чём преимущество?

Скрипт позволяет обновлять и настраивать терминалы Streamax с почти минимальным вмешательством человека и без участия мобильных устройств.
Для работы требуется ПК с возможностью выхода в сеть посредством WiFi (проводное подключение не позволяет напрямую подключиться к терминалу).




Подготовка к работе

Необходимость в подготовке нужна только при первичной установке скрипта, либо для его обновления.
Впоследствии этот шаг не требуется для работы!
Скрипт написан на Python 3.x, поэтому для корректной работы потребуется скачать соответствующую среду разработки. Сделать это можно на официальном сайте Python.




После загрузки открываем скачанный файл, обязательно ставим галочку напротив пункта PATH и запускаем установку Python.
Далее потребуется перезапустить компьютер и запустить "Подготовительный файл.pyw".

Во время работы программы откроется черное окно консоли (cmd.exe), в котором будут подгружаться различные библиотеки Python.

Страшного в них ничего нет, поэтому вам всего лишь потребуется дождаться закрытия консоли.
На этом подготовка завершена.




Путь файлов прошивок и профилей
Теперь нужно определиться с расположением папки, где будут хранится прошивки и профиль, используемые при обновлении терминала. 

По умолчанию это диск C и буквально на русском написанная папка "скрипт".

К примеру, для прошивки C29N у нас должен быть следующий путь:

"C:\скрипт\ST_C29N V3.3.28_RC24031970". 
Если по каким-либо причинам путь по умолчанию вас не устраивает, его всегда можно поменять .
Сделать это можно посредством самой среды Python.
Для этого потребуется нажать правой кнопкой мыши на "Скрипт для Streamax", выбрать "Edit with IDLE" и изменить "значение" переменных, выбрав нужные пути к файлам прошивок.

Примечание:

- Путь должен содержать два символа слэша "\\", а не один "\".
- Пути должны быть заключены либо в одинарные ' ', либо в двойные " " кавычки, как это указано в самом файле.
- Все символы пути должны точно совпадать с реальным расположением файлов прошивок.

И, главное, не забудьте сохранить изменения :)
Закончив с этим, можно приступать к настройке терминалов Streamax.




Как запускать скрипт по нажатию клавиш?
Хоть скрипт и запускается достаточно просто, двойным нажатием на него, даже этот процесс можно ускорить, установив в качестве элемента запуска комбинацию клавиш CTRL+ALT+X, где X - любая понравившаяся вам клавиша.

Для этого нужно нажать правой кнопкой мыши на "Скрипт для Streamax", отправить ярлык на рабочий стол и назначить для его запуска комбинацию клавиш.
Таким образом, скрипт будет запускаться по нажатию клавиш CTRL+ALT+D (для примера).




Как пользоваться скриптом?

Для начала потребуется подключиться к WiFi нужного терминала через ПК, иначе программа попросту не запустится.

После успешного подключения запускаем скрипт и ждём открытия браузера Chromium (синий ярлык Google Chrome).

Когда автоматически будет введён логин/пароль для входа в устройство и показана прямая трансляция с камер, скрипт будет готов исполнять команды в порядке очерёдности (то есть не завершив один пункт, вы не сможете перейти к следующему):



1. Обновление камеры C29N:

ALT+1 - запуск обновления камеры C29N (после завершения обновления нужно подтвердить выполнение шага на ALT+Q, иначе не сможете перейти к следующим этапам).

ALT+Q - пропустить шаг обновления камеры C29N и перейти к следующему этапу.

ALT+R - выйти из программы.

Если что-то не получилось с обновлением до нажатия ALT+Q, всё можно повторить по нажатию комбинации ALT+1.

 

2. Обновление прошивки терминала M1N или ADPlus:

ALT+2 - запуск обновления прошивки M1N (после завершения обновления нужно подтвердить выполнение шага на ALT+W, иначе не сможете перейти к следующим этапам).

ЛИБО

ALT+3 - запуск обновления прошивки ADPlus (после завершения обновления нужно подтвердить выполнение шага на ALT+W, иначе не сможете перейти к следующим этапам).

ALT+W - пропустить шаг обновления терминала M1N (или ADPlus) и перейти к следующему этапу.

ALT+R - выйти из программы.

Если что-то не получилось с обновлением до нажатия ALT+W, всё можно повторить по нажатию комбинации ALT+2 или ALT+3.

 

3. Загрузка профиля настроек:

ALT+4 - загрузка профиля настроек для работы 3-го канала DMS-камеры.
После нажатия ALT+4 скрипт автоматически переходит к прямой трансляции DMS-камеры на 3-м канале и включает калибровку.
После того, как камера была отрегулирована, нужно нажать на любую клавишу для выключения калибровки.

ЛИБО

ALT+5 - загрузка профиля настроек для работы 5-го канала DMS-камеры.
После нажатия ALT+5 скрипт автоматически переходит к прямой трансляции DMS-камеры на 5-м канале и включает калибровку.
После того, как камера была отрегулирована, нужно нажать на любую клавишу для выключения калибровки.

ЛИБО

ALT+6 - загрузка профиля настроек для работы 6-го канала DMS-камеры (для новых версий Streamax).
После нажатия ALT+6 скрипт автоматически переходит к прямой трансляции DMS-камеры на 6-м канале и включает калибровку.
После того, как камера была отрегулирована, нужно нажать на любую клавишу для выключения калибровки.

ЛИБО

ALT+0 - включение калибровки 3 канала без загрузки профиля (специальный пункт для ADPlus).
Так как после загрузки профиля ADPlus всегда отключается от WiFi на 5-10 секунд, выполнить автоматизированную (с последующим переходом к калибровке) настройку устройства не представляется возможным.
Для этого и была придумана следующая функция. Когда прошивка ADPlus'а обновлена, нужно самостоятельно загрузить на него профиль (нажав ALT+A), нажав в той же вкладке на пункт "конфигурация" + "просмотреть" + "обновить", и после этого запускать ALT+0.
Тогда ADPlus будет настраиваться без проблем.

ALT+R - выйти из программы.

Если что-то не получилось с профилем, нужно довести программу до завершения калибровки камеры и тогда всё можно будет повторить заново по нажатию комбинации ALT+4/5/6/0 соответственно.

После завершения шага 3 (загрузка профиля) весь цикл настройки может быть воспроизведён вновь с шага 1 (обновление C29N) без закрытия программы.

Также во время любого шага можно вызвать меню веб-интерфейса Streamax для нестандартной настройки терминала по нажатию ALT+A.




Возможные ошибки

1. Скрипт совсем не запускается или стабильно вылетает на одном и том же моменте.
- Возможно, вы что-то неправильно ввели на этапе заполнения путей файлов. Проверьте слэши, скобки, кавычки.
Также убедитесь, что названия файлов в точности соответствуют тому, что вы ввели в пути.

2. При настройке ADPlus устройство периодически отключает WiFi каждую минуту или две.
- К сожалению, проблема была актуальна и для настройки на мобильных устройствах, хоть и не настолько часто. Пока что решения этой проблемы нет и вряд ли оно появится, т.к. проблема кроется в непосредственно веб-интерфейсе Streamax'а).
Как вариант, каждую минуту нажимать два раза на кнопку ADPlus, чтобы WiFi не отключался.

3. На этапе загрузки профиля выскакивает окошко с ошибкой "Only 2 DMS", помеченной желтым цветом.
- Перезапустите скрипт.
Также при наличии желания и возможности напишите мне в Teams, дабы я оперативно смог среагировать.

4. Черные экраны на камерах при просмотре прямой трансляции.
- Скрипт прямиком и полностью состоит из циклов (прерывающих ход программного движения времени), что означает, что ежесекундное обновление камер в режиме реального времени недоступно до тех пор, пока вы из этого цикла не выйдете. Только вот выйти из цикла нельзя, так как сам по себе скрипт - цикл.
Простыми словами, перезагрузите скрипт :)

5. Скрипт не переходит к следующим шагам.
- Быть может, вы забыли подтвердить прохождение шага на ALT+Q (для C29N) или ALT+W (для M1N или ADPlus)?
Если да, то нажмите указанные комбинации, наблюдайте чудо и двигайтесь дальше.

6. Из-за скрипта буквы в системе/компьютере печатаются медленнее или в целом компьютер стал работать медленнее.
- Программа действительно потребляет много ресурсов устройства, однако, полная работоспособность компьютера восстанавливается при выходе из скрипта по нажатию ALT+R.

7. Я закрыл скрипт по нажатию крестика в браузере, то есть не нажимая ALT+R. Что делать?
- Велика вероятность того, что скрипт продолжит свою работу скрытно, продолжая потреблять ресурсы компьютера.
Чтобы завершить его работу в таком случае, нажмите комбинацию клавиш - ALT+Q, ALT+W, ALT+4, ALT+5, ALT+R.
